---
layout: post
title: C_指针
fullview: true
---

###一、数据类型的本质

####数据类型的概念

“类型”是对数据的抽象

类型相同的数据有相同的形式、存储格式以及相关的操作

程序中使用的所有数据都必定属于某一种数据类型

简单类型
基本类型：整型（int）、浮点型（float，double）、字符型（char）、空类型（void）

用户定义类型：枚举类型（enum）

结构类型
数组（［］）、结构（struct）、联合（union）、类（class）

指针类型
（＊）

####数据类型的本质
数据类型可理解为创建变量的模具，是固定内存大小的别名。

数据类型的作用：编译器预算变量分配内存空间的大小。

###二、变量的本质

既能读又能写的内存对象称为变量；若一旦初始化后不能修改的变量称为常量。

程序通过变量来申请和命名内存空间

通过变量名访问内存空间：（一段连续）内存空间的别名（是个门牌号）

修改变量方式：

1.直接

2.间接：内存有地址编号，拿到地址编号即可进行修改内存。

###三、内存四区模型
栈区（stack）：由编译器自动分配释放，存放函数的参数值、局部变量值等。

堆区（heap）：一般由程序员分配释放（动态内存申请和释放），若程序员不释放，则程序结束时可能由操作系统回收。

全局区（静态区）（static）：全局变量和静态变量的存储是放在一块的，初始化的全局变量和静态变量在一块区域，未初始化的全局变量和未初始化的静态变量在相邻的另一块区域，该区域在程序结束后由操作系统释放。常量：字符串常量和其它常量的存储位置，程序结束后由操作系统释放。

程序代码区：存放函数体的二进制代码。

静态存储区的理解
{% highlight C %}
char* getPtr1() {
	char *p1 = "abcdefg";
	return p1;
}
char* getPtr2() {
	char *p2 = "abcdefg";
	return p2;
}

void main() {
	char *ptr1 = NULL;
	char *ptr2 = NULL;
	ptr1 = getPtr1();
	ptr2 = getPtr2();

	printf("p1:%s , p2:%s \n", p1, p2);
	printf("p1:%p , p2:%p \n", p1, p2);
}
{% endhighlight %}
此时ptr1和ptr2所指向的内存区域为同一个地址。

输出结果为：
![output_0](/assets/posts/pointer/0.png)

###四、指针
一级指针、二级指针、多级指针。

####1.指针也是一种数据类型

1) 指针也是一种变量，占有内存空间，用来保存内存地址。

2) *变量名 操作内存

   在指针声明时，＊表示所声明的变量为指针

   在指针使用时，＊表示指针所指向的内存空间中的值

3) 指针变量和它指向的内存块是两个不同的概念。
   
   给指针变量赋值，只会改变指针变量值，不会改变所指向的内容；

   给＊p赋值，只会改变所指向内存块的值，不会改变指针变量的值；

   ＊p位于＝左边，表示给内存赋值；＊p位于＝右边相当于取值；

   需要进行修改指针所指向的内存空间数据时，必须要保证所指向的内存块能够修改。(重要)

接上例
{% highlight C %}
//此处报错，ptr2所指向内存区为常量区，被操作系统所保护，常量区的内容不能进行修改。
*(ptr2 + 3) = '2'; //修改ptr2所指向的内存块第3个位置的值，即d修改为2
{% endhighlight %}

4) 指针是一种数据类型，是指它所指向的内存空间的数据类型

指针的数据类型决定了指针步长（p++），指针步长根据所指内存空间的数据类型来确定。

注意：

建立指针指向谁，就是把谁的地址赋值给指针。

不断给指针变量赋值，就是不断的改变指针变量（但和所指向内存空间没有任何关系）。





